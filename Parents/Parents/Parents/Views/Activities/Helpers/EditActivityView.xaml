<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Parents.Views.Activities.Helpers.EditActivityView"
             BindingContext="{Binding Main, Source={StaticResource Locator}}"
             Title="{Binding EditActivity.ChildrenActivityType, StringFormat='EDIT {0}'}"
             BackgroundColor="{StaticResource BackgroundColor}"
             xmlns:busyindicator="clr-namespace:Syncfusion.SfBusyIndicator.XForms;assembly=Syncfusion.SfBusyIndicator.XForms"
             xmlns:local="clr-namespace:Parents.Renderers">
    
    <ContentPage.ToolbarItems>
        <ToolbarItem 
            Icon="ic_edit_white_a"
            Clicked="ToolbarItem_Clicked_1"/>
        
        <ToolbarItem 
            Command="{Binding EditActivity.SaveRepeatedEventsCommand}"
            Icon="ic_save"
            IsEnabled="{Binding IsEnabled, Mode=TwoWay}"
            Clicked="ToolbarItem_Clicked"/>
    </ContentPage.ToolbarItems>

    <Grid
        RowSpacing="0"
        BindingContext="{Binding EditActivity}">
        <Grid.RowDefinitions>
            <RowDefinition Height="AUTO"/>
            <RowDefinition Height="AUTO"/>
            <RowDefinition Height="AUTO"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!--HEADER SECTION-->
        <Image
            Source="Activities"
            Aspect="AspectFill"            
            Grid.Row="0"
            HeightRequest="150"/>

        <!--ACTIVITY BRIEF INFO-->
        <StackLayout
            Grid.Row="1"
            HeightRequest="40"
            HorizontalOptions="CenterAndExpand"
            Padding="0,60,0,0">

            <local:CustomEntry
                Text="{Binding ActivityDescription}"
                FontSize="Large"
                IsEnabled="False"
                x:Name="DescriptionLabel">
                <Entry.GestureRecognizers>
                    <TapGestureRecognizer Tapped="ClickGestureRecognizer_Clicked"/>
                </Entry.GestureRecognizers>
            </local:CustomEntry>

        </StackLayout>

        <!--PRIVACY/ PRIORITY/ STATUS SECTIONS-->
        <Grid
            Grid.Row="2"
            Margin="0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <StackLayout
                Grid.Column="0"
                x:Name="privacyBox">
                               
                <Image Source="{Binding ActivityPrivacyImage}"
                       HeightRequest="30"
                       Margin="0,5"/>

                <Label 
                    Text="Privacy" 
                    Style="{StaticResource StatsCaptionLabel}"
                    IsEnabled="False"
                    x:Name="lblPrivacy">
                </Label>
                
                <StackLayout.GestureRecognizers>
                    <TapGestureRecognizer Command="{Binding PrivacyChangeCommand}"/>
                </StackLayout.GestureRecognizers>
            </StackLayout>

            <StackLayout
                Grid.Column="1">
                                
                <Image Source="{Binding ActivityPriorityImage}" 
                       HeightRequest="30"
                       Margin="0,5"/>

                <Label Text="Priority" Style="{StaticResource StatsCaptionLabel}"/>
            </StackLayout>

            <StackLayout
                Grid.Column="2">

                <Image Source="{Binding ActivityTypeImage}" 
                       HeightRequest="30"
                       Margin="0,5"/>

                <Label Text="Type" Style="{StaticResource StatsCaptionLabel}"/>

            </StackLayout>

            <StackLayout
                Grid.Column="3">
                
                <Image Source="{Binding ActivityStatusImage}" 
                       HeightRequest="30"
                       Margin="0,5"/>

                <Label Text="Status" Style="{StaticResource StatsCaptionLabel}"/>
            </StackLayout>

        </Grid>

        <!--ACTIVITY DETAILS SECTION-->
            <ScrollView
                Grid.Row="3"
                Orientation="Vertical">
                
                <StackLayout
                Orientation="Vertical"
                Spacing="10"
                Padding="8">

                    <Label 
                    Text="{Binding ActivityDateStart}"
                    FontSize="Medium"/>

                    <Label 
                    Text="{Binding ActivityDateEnd}"
                     FontSize="Medium"/>

                    <Label
                    Text="{Binding ChildrenActivityType}"
                     FontSize="Medium"/>

                </StackLayout>
            </ScrollView>

        <!--ACTIVITY IMAGE SECTION-->

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="AUTO"/>
            </Grid.RowDefinitions>

            <Image
                Source="{Binding ImageSource}"
                HorizontalOptions="Center"
                WidthRequest="150"
                HeightRequest="150"
                VerticalOptions="End"
                TranslationY="50"
                BackgroundColor="Beige"
                Grid.Row="0"
                x:Name="ActivityImage"
                Aspect="AspectFill">
                <Image.GestureRecognizers>
                    <TapGestureRecognizer Tapped="TapGestureRecognizer_Tapped" />
                </Image.GestureRecognizers>
            </Image>
        </Grid>

        <ContentView 
            x:Name="contentView" 
            IsVisible="{Binding IsRunning, Mode=TwoWay}" 
            HorizontalOptions="FillAndExpand"
            VerticalOptions="FillAndExpand" 
            BackgroundColor="Black" 
            Opacity="0.5">
            <busyindicator:SfBusyIndicator 
                x:Name="BusyIndicator"
                AnimationType="HorizontalPulsingBox"
                IsBusy="{Binding IsRunning, Mode=TwoWay}" 
                TextColor="White"/>
        </ContentView>

    </Grid>


</ContentPage>